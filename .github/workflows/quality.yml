name: Rust Code Quality

on:
  pull_request:
    branches: "**"
  workflow_dispatch:

jobs:
  quality-check:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Clone du dÃ©pÃ´t
        run: |
          git clone ${{ github.server_url }}/${{ github.repository }} .
          git fetch --all

      - name: ğŸ› ï¸ Installer Rust
        run: |
          curl https://sh.rustup.rs -sSf | sh -s -- -y --default-toolchain stable
          source $HOME/.cargo/env
          rustup component add rustfmt clippy
          cargo install cargo-audit

      - name: âœ… VÃ©rification formatage (rustfmt)
        run: |
          source $HOME/.cargo/env
          cargo fmt --all -- --check

      - name: ğŸ” Linting (clippy)
        run: |
          source $HOME/.cargo/env
          cargo clippy -- -D warnings

      - name: ğŸ›¡ï¸ Audit de sÃ©curitÃ©
        run: |
          source $HOME/.cargo/env
          cargo audit
